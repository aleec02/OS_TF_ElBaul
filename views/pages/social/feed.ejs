<%- contentFor('body') %>

<div class="container-fluid py-4">
    <div class="row">
        <!-- Main Feed -->
        <div class="col-lg-8">
            <!-- Create Post Section -->
            <div class="card mb-4 shadow-sm">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <img src="<%= user ? user.avatar_url || '/img/default-avatar.png' : '/img/default-avatar.png' %>" 
                             class="rounded-circle me-3" width="50" height="50" alt="Avatar">
                        <div>
                            <h6 class="mb-0"><%= user ? user.nombre : 'Usuario' %></h6>
                            <small class="text-muted">Comparte tu experiencia</small>
                        </div>
                    </div>
                    
                    <form id="createPostForm">
                        <div class="mb-3">
                            <textarea class="form-control" id="postContent" rows="3" 
                                      placeholder="¿Qué quieres compartir hoy? Cuéntanos sobre tus compras, productos favoritos, o consejos..."></textarea>
                        </div>
                        
                        <div class="mb-3">
                            <label for="postImages" class="form-label">
                                <i class="fas fa-images me-1"></i>Agregar imágenes
                            </label>
                            <input type="file" class="form-control" id="postImages" multiple accept="image/*">
                            <div id="imagePreview" class="mt-2 d-flex flex-wrap gap-2"></div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="relatedProduct" class="form-label">
                                <i class="fas fa-tag me-1"></i>Producto relacionado (opcional)
                            </label>
                            <select class="form-select" id="relatedProduct">
                                <option value="">Seleccionar producto...</option>
                            </select>
                        </div>
                        
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="publicPost" checked>
                                <label class="form-check-label" for="publicPost">
                                    <i class="fas fa-globe me-1"></i>Público
                                </label>
                            </div>
                            <button type="submit" class="btn btn-primary" id="submitPost">
                                <i class="fas fa-paper-plane me-1"></i>Publicar
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Posts Feed -->
            <div id="postsFeed">
                <div class="text-center py-5">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Cargando...</span>
                    </div>
                    <p class="mt-3">Cargando publicaciones...</p>
                </div>
            </div>

            <!-- Load More Button -->
            <div class="text-center mt-4" id="loadMoreContainer" style="display: none;">
                <button class="btn btn-outline-primary" id="loadMorePosts">
                    <i class="fas fa-plus me-1"></i>Cargar más publicaciones
                </button>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="col-lg-4">
            <!-- Trending Topics -->
            <div class="card mb-4 shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-fire me-2"></i>Tendencias
                    </h5>
                </div>
                <div class="card-body">
                    <div id="trendingTopics">
                        <div class="d-flex justify-content-center">
                            <div class="spinner-border spinner-border-sm text-primary" role="status"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Suggested Users -->
            <div class="card mb-4 shadow-sm">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-users me-2"></i>Usuarios Sugeridos
                    </h5>
                </div>
                <div class="card-body">
                    <div id="suggestedUsers">
                        <div class="d-flex justify-content-center">
                            <div class="spinner-border spinner-border-sm text-success" role="status"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="card shadow-sm">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-clock me-2"></i>Actividad Reciente
                    </h5>
                </div>
                <div class="card-body">
                    <div id="recentActivity">
                        <div class="d-flex justify-content-center">
                            <div class="spinner-border spinner-border-sm text-info" role="status"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Post Template (Hidden) -->
<template id="postTemplate">
    <div class="card mb-4 shadow-sm post-card">
        <div class="card-header bg-transparent">
            <div class="d-flex align-items-center">
                <img src="" class="rounded-circle me-3 post-avatar" width="40" height="40" alt="Avatar">
                <div class="flex-grow-1">
                    <h6 class="mb-0 post-author"></h6>
                    <small class="text-muted post-date"></small>
                </div>
                <div class="dropdown">
                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                        <i class="fas fa-ellipsis-h"></i>
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#" data-action="share"><i class="fas fa-share me-2"></i>Compartir</a></li>
                        <li><a class="dropdown-item" href="#" data-action="report"><i class="fas fa-flag me-2"></i>Reportar</a></li>
                        <li class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-danger" href="#" data-action="delete"><i class="fas fa-trash me-2"></i>Eliminar</a></li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="card-body">
            <p class="card-text post-content"></p>
            
            <div class="post-images mb-3" style="display: none;">
                <div class="row g-2">
                    <!-- Images will be inserted here -->
                </div>
            </div>
            
            <div class="related-product mb-3" style="display: none;">
                <div class="card border">
                    <div class="card-body p-3">
                        <div class="d-flex align-items-center">
                            <img src="" class="me-3 related-product-image" width="60" height="60" alt="Product">
                            <div>
                                <h6 class="mb-1 related-product-title"></h6>
                                <p class="mb-1 text-primary related-product-price"></p>
                                <a href="#" class="btn btn-sm btn-outline-primary related-product-link">Ver producto</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex gap-3">
                    <button class="btn btn-sm btn-outline-primary post-like-btn">
                        <i class="fas fa-heart me-1"></i>
                        <span class="like-count">0</span>
                    </button>
                    <button class="btn btn-sm btn-outline-secondary post-comment-btn">
                        <i class="fas fa-comment me-1"></i>
                        <span class="comment-count">0</span>
                    </button>
                    <button class="btn btn-sm btn-outline-success post-share-btn">
                        <i class="fas fa-share me-1"></i>Compartir
                    </button>
                </div>
                <small class="text-muted post-views">
                    <i class="fas fa-eye me-1"></i><span class="views-count">0</span> vistas
                </small>
            </div>
        </div>
        
        <!-- Comments Section -->
        <div class="card-footer bg-light comments-section" style="display: none;">
            <div class="comments-list mb-3">
                <!-- Comments will be loaded here -->
            </div>
            
            <form class="comment-form">
                <div class="input-group">
                    <input type="text" class="form-control comment-input" placeholder="Escribe un comentario...">
                    <button class="btn btn-primary" type="submit">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>
</template>

<!-- Comment Template (Hidden) -->
<template id="commentTemplate">
    <div class="comment-item d-flex mb-3">
        <img src="" class="rounded-circle me-2 comment-avatar" width="32" height="32" alt="Avatar">
        <div class="flex-grow-1">
            <div class="bg-white rounded p-2 border">
                <div class="d-flex justify-content-between align-items-start">
                    <div>
                        <h6 class="mb-1 comment-author"></h6>
                        <p class="mb-1 comment-content"></p>
                    </div>
                    <div class="dropdown">
                        <button class="btn btn-sm btn-link text-muted p-0" data-bs-toggle="dropdown">
                            <i class="fas fa-ellipsis-h"></i>
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" data-action="reply"><i class="fas fa-reply me-2"></i>Responder</a></li>
                            <li><a class="dropdown-item text-danger" href="#" data-action="delete"><i class="fas fa-trash me-2"></i>Eliminar</a></li>
                        </ul>
                    </div>
                </div>
                <div class="d-flex align-items-center mt-2">
                    <small class="text-muted me-3 comment-date"></small>
                    <button class="btn btn-sm btn-link text-muted p-0 comment-like-btn">
                        <i class="fas fa-heart me-1"></i>
                        <span class="comment-like-count">0</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</template> 